!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t,n){e.exports=n(21)()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(19),i=n(4);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(20);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){!function(){e.exports=this.React}()},function(e,t){!function(){e.exports=this.regeneratorRuntime}()},function(e,t){!function(){e.exports=this.wp.editor}()},function(e,t){function n(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function c(e){n(a,i,o,c,s,"next",e)}function s(e){n(a,i,o,c,s,"throw",e)}c(void 0)}))}}},function(e,t){!function(){e.exports=this.lodash}()},function(e,t){!function(){e.exports=this.wp.apiFetch}()},function(e,t){!function(){e.exports=this.wp.blocks}()},function(e,t){!function(){e.exports=this.wp.url}()},function(e,t,n){"use strict";(function(e){var n=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return(function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},t}())}(),r="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,i=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),o="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var a=["top","right","bottom","left","width","height","size","weight"],c="undefined"!=typeof MutationObserver,s=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function a(){n&&(n=!1,e()),r&&s()}function c(){o(a)}function s(){var e=Date.now();if(n){if(e-i<2)return;r=!0}else n=!0,r=!1,setTimeout(c,t);i=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){r&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),c?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){r&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;a.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),u=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},h=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||i},l=v(0,0,0,0);function f(e){return parseFloat(e)||0}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+f(e["border-"+n+"-width"])}),0)}function d(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return l;var r=h(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=e["padding-"+i];t[i]=f(o)}return t}(r),o=i.left+i.right,a=i.top+i.bottom,c=f(r.width),s=f(r.height);if("border-box"===r.boxSizing&&(Math.round(c+o)!==t&&(c-=p(r,"left","right")+o),Math.round(s+a)!==n&&(s-=p(r,"top","bottom")+a)),!function(e){return e===h(e).document.documentElement}(e)){var u=Math.round(c+o)-t,d=Math.round(s+a)-n;1!==Math.abs(u)&&(c-=u),1!==Math.abs(d)&&(s-=d)}return v(i.left,i.top,c,s)}var g="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof h(e).SVGGraphicsElement}:function(e){return e instanceof h(e).SVGElement&&"function"==typeof e.getBBox};function b(e){return r?g(e)?function(e){var t=e.getBBox();return v(0,0,t.width,t.height)}(e):d(e):l}function v(e,t,n,r){return{x:e,y:t,width:n,height:r}}var y=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=b(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),m=function(e,t){var n,r,i,o,a,c,s,h=(r=(n=t).x,i=n.y,o=n.width,a=n.height,c="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(c.prototype),u(s,{x:r,y:i,width:o,height:a,top:i,right:r+o,bottom:a+i,left:r}),s);u(this,{target:e,contentRect:h})},_=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new n,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof h(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new y(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof h(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new m(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),O="undefined"!=typeof WeakMap?new WeakMap:new n,w=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=s.getInstance(),r=new _(t,n,this);O.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){w.prototype[e]=function(){var t;return(t=O.get(this))[e].apply(t,arguments)}}));var E=void 0!==i.ResizeObserver?i.ResizeObserver:w;t.a=E}).call(this,n(23))},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";var r=n(22);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(16),o=n(3),a=n(11),c=n.n(a),s=n(13),u=n.n(s),h=n(5),l=n.n(h),f=n(6),p=n.n(f),d=n(7),g=n.n(d),b=n(8),v=n.n(b),y=n(4),m=n.n(y),_=n(9),O=n.n(_),w=n(15),E=n.n(w),k=n(12),j=n(17),S=n(14),C=n(2),A=function(e){function t(){return l()(this,t),g()(this,v()(t).apply(this,arguments))}return O()(t,e),p()(t,[{key:"render",value:function(){var e=this.props,t=e.apiKey,n=e.isApiKeySaved,i=e.isLoading,a=e.onApiKeyChange;return Object(r.createElement)(r.Fragment,null,i?Object(r.createElement)(C.Spinner,null):Object(r.createElement)(C.TextControl,{label:Object(o.__)("Enter Giphy API Key","insert-giphy-block"),onChange:a,value:t}),n&&Object(r.createElement)("div",{className:"insert-giphy-block-api-saved"},Object(o.__)("Saved","insert-giphy-block")))}}]),t}(r.Component),x=function(e){function t(){return l()(this,t),g()(this,v()(t).apply(this,arguments))}return O()(t,e),p()(t,[{key:"render",value:function(){var e=this.props,t=e.gif,n=e.onRemoveClickHandler,i=e.style;return Object(r.createElement)("div",{style:i},Object(r.createElement)("img",{alt:Object(o.__)("Selected GIF","insert-giphy-block"),src:t}),Object(r.createElement)("div",null,Object(r.createElement)(C.Button,{isDefault:!0,onClick:n},Object(r.createElement)(C.Icon,{icon:"trash"}))))}}]),t}(r.Component),T=function(e){function t(){return l()(this,t),g()(this,v()(t).apply(this,arguments))}return O()(t,e),p()(t,[{key:"render",value:function(){return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(k.InspectorControls,null,Object(r.createElement)(C.PanelBody,{initialOpen:!0,title:Object(o.__)("Insert Giphy Block Settings","insert-giphy-block")},Object(r.createElement)(A,this.props),Object(r.createElement)(C.PanelRow,null,Object(r.createElement)(C.TextControl,{label:Object(o.__)("GIF Alt","insert-giphy-block"),placeholder:Object(o.__)("Alt","insert-giphy-block"),onChange:this.props.onAltChangeHandler,value:this.props.alt})))))}}]),t}(r.Component),H=n(10),P=n.n(H),M=n(1),K=n.n(M),R=n(18);function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){I(e,t,n[t])}))}return e}function N(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var z={cursor:"pointer"},D=function(e){var t=e.index,n=e.onClick,r=e.photo,i=e.margin,o=e.direction,a=e.top,c=e.left,s=e.key,u={margin:i,display:"block"};"column"===o&&(u.position="absolute",u.left=c,u.top=a);return P.a.createElement("img",L({key:s,style:n?G({},u,z):u},r,{onClick:n?function(e){n(e,{photo:r,index:t})}:null}))},V=K.a.shape({key:K.a.string,src:K.a.string.isRequired,width:K.a.number.isRequired,height:K.a.number.isRequired,alt:K.a.string,title:K.a.string,srcSet:K.a.oneOfType([K.a.string,K.a.array]),sizes:K.a.oneOfType([K.a.string,K.a.array])});D.propTypes={index:K.a.number.isRequired,onClick:K.a.func,photo:V.isRequired,margin:K.a.number,top:function(e){if("column"===e.direction&&"number"!=typeof e.top)return new Error("top is a required number when direction is set to `column`")},left:function(e){if("column"===e.direction&&"number"!=typeof e.left)return new Error("left is a required number when direction is set to `column`")},direction:K.a.string};var W=function(e,t){return t||(t=0),Number(Math.round(e+"e"+t)+"e-"+t)},q=function(e){var t=e.width,n=e.height;return W(t/n,2)};function B(e){this.content=[],this.scoreFunction=e}B.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},remove:function(e){for(var t=this.content.length,n=0;n<t;n++)if(this.content[n]==e){var r=this.content.pop();if(n==t-1)break;this.content[n]=r,this.bubbleUp(n),this.sinkDown(n);break}},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e],n=this.scoreFunction(t);e>0;){var r=Math.floor((e+1)/2)-1,i=this.content[r];if(n>=this.scoreFunction(i))break;this.content[r]=t,this.content[e]=i,e=r}},sinkDown:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var i=2*(e+1),o=i-1,a=null;if(o<t){var c=this.content[o],s=this.scoreFunction(c);s<r&&(a=o)}if(i<t){var u=this.content[i];this.scoreFunction(u)<(null==a?r:s)&&(a=i)}if(null==a)break;this.content[e]=this.content[a],this.content[a]=n,e=a}}};var U=function(e,t,n){return function(e,t){for(var n=[],r=t;r;)n.push(r),e[r],r=e[r];return n.reverse()}(function(e,t,n){var r={},i={},o={};o[t]=0;var a=new B((function(e){return e.weight}));for(a.push({id:t,weight:0});a.size();){var c=a.pop(),s=c.id;if(!i[s]){var u=e(s)||{};for(var h in i[s]=1,u){var l=c.weight+u[h];(void 0===o[h]||o[h]>l)&&(o[h]=l,a.push({id:h,weight:l}),r[h]=s)}}}if(void 0===o[n])throw new Error("There is no path from ".concat(t," to ").concat(n));return r}(e,t,n),n)},Y=function(e,t,n){return(t-e.length*(2*n))/e.reduce((function(e,t){return e+q(t)}),0)},Q=function(e,t,n,r,i,o){var a=e.slice(t,n),c=Y(a,r,o);return Math.pow(Math.abs(c-i),2)},J=function(e){var t=e.containerWidth,n=e.limitNodeSearch,r=e.targetRowHeight,i=e.margin,o=e.photos,a=function(e,t,n,r,i){return function(o){var a={};a[+(o=+o)]=0;for(var c=o+1;c<n.length+1&&!(c-o>r);++c)a[c.toString()]=Q(n,o,c,t,e,i);return a}}(r,t,o,n,i),c=U(a,"0",o.length);c=c.map((function(e){return+e}));for(var s=1;s<c.length;++s)for(var u=o.slice(c[s-1],c[s]),h=Y(u,t,i),l=c[s-1];l<c[s];++l)o[l].width=W(h*q(o[l]),1),o[l].height=h;return o},X=P.a.memo((function(e){var t=e.photos,n=e.onClick,r=e.direction,i=e.margin,o=e.limitNodeSearch,a=e.targetRowHeight,c=e.columns,s=e.renderImage,u=F(Object(H.useState)(0),2),h=u[0],l=u[1],f=Object(H.useRef)(null);Object(H.useLayoutEffect)((function(){var e=null,t=new R.a((function(t){var n=t[0].contentRect.width;h!==n&&(e=window.requestAnimationFrame((function(){l(Math.floor(n))})))}));return t.observe(f.current),function(){t.disconnect(),window.cancelAnimationFrame(e)}}));var p=function(e,r){var i=r.index;n(e,{index:i,photo:t[i],previous:t[i-1]||null,next:t[i+1]||null})};if(!h)return P.a.createElement("div",{ref:f}," ");var d,g,b=h-1;"row"===r&&("function"==typeof o&&(o=o(h)),"function"==typeof a&&(a=a(h)),void 0===o&&(o=2,h>=450&&(o=function(e){var t=e.targetRowHeight,n=e.containerWidth;return W(n/t/1.5)+8}({containerWidth:h,targetRowHeight:a}))),d={display:"flex",flexWrap:"wrap",flexDirection:"row"},g=J({containerWidth:b,limitNodeSearch:o,targetRowHeight:a,margin:i,photos:t})),"column"===r&&("function"==typeof c&&(c=c(h)),void 0===c&&(c=1,h>=500&&(c=2),h>=900&&(c=3),h>=1500&&(c=4)),d={position:"relative"},g=function(e){for(var t=e.photos,n=e.columns,r=e.containerWidth,i=e.margin,o=(r-2*i*n)/n,a=t.map((function(e){var t=e.height/e.width*o;return G({},e,{width:W(o,1),height:W(t,1)})})),c=[],s=[],u=0;u<n;u++)c[u]=W(u*(o+2*i),1),s[u]=0;return a.map((function(e){var t=s.reduce((function(e,t,n){return e=t<s[e]?n:e}),0);e.top=s[t],e.left=c[t],s[t]=s[t]+e.height+2*i;var n=s.reduce((function(e,t,n){return e=t>s[e]?n:e}),0);return e.containerHeight=s[n],e}))}({containerWidth:b,columns:c,margin:i,photos:t}),d.height=g[g.length-1].containerHeight);var v=s||D;return P.a.createElement("div",{className:"react-photo-gallery--gallery"},P.a.createElement("div",{ref:f,style:d},g.map((function(e,t){var o=e.left,a=e.top,c=e.containerHeight,s=N(e,["left","top","containerHeight"]);return v({left:o,top:a,key:e.key||e.src,containerHeight:c,index:t,margin:i,direction:r,onClick:n?p:null,photo:s})}))))}));X.propTypes={photos:K.a.arrayOf(V).isRequired,direction:K.a.string,onClick:K.a.func,columns:K.a.oneOfType([K.a.func,K.a.number]),targetRowHeight:K.a.oneOfType([K.a.func,K.a.number]),limitNodeSearch:K.a.oneOfType([K.a.func,K.a.number]),margin:K.a.number,renderImage:K.a.func},X.defaultProps={margin:2,direction:"row",targetRowHeight:300};var Z=X,$=function(e){function t(){return l()(this,t),g()(this,v()(t).apply(this,arguments))}return O()(t,e),p()(t,[{key:"render",value:function(){var e,t=this.props,n=t.error,i=t.gifs,a=t.isLoading,c=t.maxPage,s=t.onGiphyClick,u=t.onPaginationChangeHandler,h=t.onSearchChangeHandler,l=t.pagination,f=t.search;return i[l]&&(e=[],e=i[l].map((function(e){return{height:e.images.original.height,src:e.images.original.url,width:e.images.original.width}}))),Object(r.createElement)(r.Fragment,null,Object(r.createElement)(C.TextControl,{label:Object(o.__)("Search GIF","insert-giphy-block"),onChange:h,placeholder:Object(o.__)("Search GIF","insert-giphy-block"),value:f}),a&&Object(r.createElement)("div",{className:"giphy_spinner_container"},Object(r.createElement)(C.Spinner,null)),n&&Object(r.createElement)("div",{className:"components-notice is-error"},Object(r.createElement)("div",{className:"components-notice__content"},n.message)),e&&e.length>0&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(Z,{onClick:s,photos:e}),Object(r.createElement)("div",{className:"giphy_nav_controls"},l>1&&Object(r.createElement)("div",{className:"giphy_nav_controls__control"},Object(r.createElement)(C.Button,{isLink:!0,onClick:function(){return u(l-1)}},Object(r.createElement)(C.Icon,{size:"32",icon:"controls-back"}))),Object(r.createElement)("div",{className:"giphy_nav_controls__control"},Object(r.createElement)(C.TextControl,{className:"giphy_nav_field",onChange:function(e){if(isNaN(e)||e<=0)return 1;e>c&&(e=c),u(e)},value:l})),Object(r.createElement)("div",{className:"giphy_nav_controls__control"},"/"),Object(r.createElement)("div",{className:"giphy_nav_controls__control"},c),l<c&&Object(r.createElement)("div",{className:"giphy_nav_controls__control"},Object(r.createElement)(C.Button,{isLink:!0,onClick:function(){return u(l+1)}},Object(r.createElement)(C.Icon,{size:"32",icon:"controls-forward"}))))),e&&0===e.length&&Object(r.createElement)("p",null,Object(o.sprintf)(Object(o.__)('Nothing found for "%s".',"insert-giphy-block"),f)))}}]),t}(r.Component),ee=function(e){function t(e){var n;return l()(this,t),(n=g()(this,v()(t).call(this,e))).state={apiKey:"",error:!1,gifs:[],isApiKeySaved:!1,isLoading:!1,isProcessingApiKey:!0,isSearching:!e.attributes.gif,isTypingApiKey:!1,maxPage:0,pagination:1},n.GIPHY_ENDPOINT="https://api.giphy.com/v1/gifs/search",n.GIPHY_RESULTS_LIMIT=10,n.fetchGiphy=n.fetchGiphy.bind(m()(n)),n.onApiKeyChange=n.onApiKeyChange.bind(m()(n)),n.onApiKeyChangeHandler=Object(S.debounce)(n.onApiKeyChangeHandler.bind(m()(n)),500),n.onSearchChangeHandler=n.onSearchChangeHandler.bind(m()(n)),n.onSearchChange=Object(S.debounce)(n.onSearchChange.bind(m()(n)),500),n.onGiphyClick=n.onGiphyClick.bind(m()(n)),n.onRemoveClickHandler=n.onRemoveClickHandler.bind(m()(n)),n.updateIsApiKeySavedToFalse=n.updateIsApiKeySavedToFalse.bind(m()(n)),n.onPaginationChangeHandler=n.onPaginationChangeHandler.bind(m()(n)),n.onAltChangeHandler=n.onAltChangeHandler.bind(m()(n)),n}var n,i,o;return O()(t,e),p()(t,[{key:"componentDidMount",value:(o=u()(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchApiKey();case 2:t=e.sent,this.setState({apiKey:t,isProcessingApiKey:!1});case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.onSearchChange.cancel(),this.onApiKeyChangeHandler.cancel()}},{key:"fetchApiKey",value:function(){return E()({path:"/dminsertgiphyblock/v1/api-key"}).then((function(e){return e})).catch((function(e){return e}))}},{key:"saveApiKey",value:function(e){return E()({path:"/dminsertgiphyblock/v1/api-key",method:"POST",body:e}).catch((function(e){return e}))}},{key:"onSearchChange",value:(i=u()(c.a.mark((function e(){var t,n,r,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.attributes.search,!this.state.gifs[this.state.pagination]){e.next=4;break}return this.setState({isLoading:!1}),e.abrupt("return");case 4:return n=(this.state.pagination-1)*this.GIPHY_RESULTS_LIMIT,e.next=7,this.fetchGiphy(t,n);case 7:if((r=e.sent).meta&&200===r.meta.status){e.next=11;break}return this.setState({error:r,isLoading:!1}),e.abrupt("return");case 11:(i=this.state.gifs)[this.state.pagination]=r.data,o={error:!1,isLoading:!1,gifs:i},0===this.state.maxPage&&(o.maxPage=Math.ceil(r.pagination.total_count/this.GIPHY_RESULTS_LIMIT)),this.setState(o);case 16:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"fetchGiphy",value:function(e,t){var n=Object(j.addQueryArgs)(this.GIPHY_ENDPOINT,{q:e,limit:this.GIPHY_RESULTS_LIMIT,api_key:this.state.apiKey,offset:t});return fetch(n).then((function(e){return e.json()})).catch((function(e){return e}))}},{key:"onGiphyClick",value:function(e,t){var n=t.photo;this.props.setAttributes({gif:n}),this.setState({isSearching:!1})}},{key:"onSearchChangeHandler",value:function(e){this.setState({error:!1,gifs:[],isLoading:!0,maxPage:0,pagination:1}),this.props.setAttributes({search:e}),this.onSearchChange()}},{key:"onPaginationChangeHandler",value:function(e){this.setState({isLoading:!0,pagination:Number(e)}),this.onSearchChange()}},{key:"onRemoveClickHandler",value:function(){this.setState({isLoading:!0,isSearching:!0}),this.onSearchChange()}},{key:"onApiKeyChange",value:function(e){this.setState({apiKey:e,isTypingApiKey:!0}),this.onApiKeyChangeHandler()}},{key:"onApiKeyChangeHandler",value:(n=u()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isProcessingApiKey:!0}),e.next=3,this.saveApiKey(this.state.apiKey);case 3:this.setState({isApiKeySaved:!0,isProcessingApiKey:!1,isTypingApiKey:!1}),Object(S.delay)(this.updateIsApiKeySavedToFalse,3e3);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onAltChangeHandler",value:function(e){this.props.setAttributes({alt:e})}},{key:"updateIsApiKeySavedToFalse",value:function(){this.setState({isApiKeySaved:!1})}},{key:"render",value:function(){var e=this.props,t=e.attributes,n=t.alt,i=t.blockAlignment,o=t.gif,a=t.search,c=t.textAlignment,s=e.className,u=e.setAttributes,h=this.state,l=h.apiKey,f=h.error,p=h.gifs,d=h.isApiKeySaved,g=h.isLoading,b=h.isProcessingApiKey,v=h.isSearching,y=h.isTypingApiKey,m=h.maxPage,_=h.pagination,O=!1;(0===l.length||y)&&(O=!0);var w=!1;return o&&o.src&&!v&&(w=!0),Object(r.createElement)("div",{className:s},Object(r.createElement)(T,{alt:n,apiKey:l,isApiKeySaved:d,isLoading:b,onAltChangeHandler:this.onAltChangeHandler,onApiKeyChange:this.onApiKeyChange}),O?Object(r.createElement)(A,{apiKey:l,isApiKeySaved:d,isLoading:b,onApiKeyChange:this.onApiKeyChange}):w?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(k.BlockControls,null,Object(r.createElement)(k.BlockAlignmentToolbar,{onChange:function(e){return u({blockAlignment:e})},value:i}),Object(r.createElement)(k.AlignmentToolbar,{onChange:function(e){return u({textAlignment:e})},value:c})),Object(r.createElement)(x,{gif:o.src,onRemoveClickHandler:this.onRemoveClickHandler,style:{textAlign:c}})):Object(r.createElement)($,{error:f,gifs:p,isLoading:g,onGiphyClick:this.onGiphyClick,onPaginationChangeHandler:this.onPaginationChangeHandler,onSearchChangeHandler:this.onSearchChangeHandler,maxPage:m,pagination:_,search:a}))}}]),t}(r.Component),te=Object(r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"27",version:"1",viewBox:"0 0 210 270"},Object(r.createElement)("path",{fill:"#000",stroke:"none",d:"M0 135V0h80c64 0 80 3 80 15 0 8 5 15 10 15 6 0 10 7 10 15s7 15 15 15c12 0 15 18 15 105v105H0V135z"}),Object(r.createElement)("path",{fill:"#5c1f99",stroke:"none",d:"M0 135V0h80c64 0 80 3 80 15 0 8 5 15 10 15 6 0 10 7 10 15s7 15 15 15c12 0 15 18 15 105v105H0V135zm180 30V90h-30c-27 0-30-3-30-30 0-29-2-30-45-30H30v210h150v-75z"}),Object(r.createElement)("path",{fill:"#9d9039",stroke:"none",d:"M0 135V0h80c64 0 80 3 80 15 0 8 5 15 10 15 6 0 10 7 10 15s7 15 15 15c12 0 15 18 15 105v105H0V135zm180 42c0-36 5-68 12-75 9-9 3-12-30-12-40 0-42-1-42-30s-2-30-45-30H30v210h150v-63z"}),Object(r.createElement)("path",{fill:"#7928c9",stroke:"none",d:"M0 135V0h80c64 0 80 3 80 15 0 8 5 15 10 15 6 0 10 7 10 15s7 15 15 15c12 0 15 18 15 105v105H0V135zm180 42c0-36 5-68 12-75 9-9 3-12-30-12h-42V48c0-33-3-39-12-30-7 7-27 12-45 12H30v210h150v-63z"}),Object(r.createElement)("path",{fill:"#0f9",stroke:"none",d:"M0 135V0h80c64 0 80 3 80 15 0 8 5 15 10 15 6 0 10 7 10 15s7 15 15 15 15 7 15 15c0 11-12 15-45 15h-45V48c0-33-3-39-12-30-7 7-27 12-45 12H30v210h150v-59c0-40 5-63 15-71 13-11 15-2 15 74v86H0V135z"}),Object(r.createElement)("path",{fill:"#0cf",stroke:"none",d:"M0 255c0-12 17-15 90-15h90v-59c0-40 5-63 15-71 13-11 15-2 15 74v86H105c-87 0-105-3-105-15z"}),Object(r.createElement)("path",{fill:"#f66",stroke:"none",d:"M120 48c0-33-3-39-12-30C90 36 0 34 0 15 0 3 16 0 80 0s80 3 80 15c0 8 5 15 10 15 6 0 10 7 10 15s7 15 15 15 15 7 15 15c0 11-12 15-45 15h-45V48z"}),Object(r.createElement)("path",{fill:"#93f",stroke:"none",d:"M180 181c0-40 5-63 15-71 13-11 15-3 15 59 0 56-3 71-15 71s-15-13-15-59z"}),Object(r.createElement)("path",{fill:"#cabe4a",stroke:"none",d:"M0 15C0 3 13 0 61 0c54 0 60 2 49 15C93 36 0 36 0 15z"}),Object(r.createElement)("path",{fill:"#fff35c",stroke:"none",d:"M0 15C0 3 13 0 56 0c49 0 55 2 44 15-8 9-30 15-56 15-32 0-44-4-44-15z"}));Object(i.registerBlockType)("donmhico/insert-giphy-block",{title:Object(o.__)("Insert Giphy Block","insert-giphy-block"),description:Object(o.__)("Search and insert a Giphy directly from your Gutenberg editor.","insert-giphy-block"),category:"embed",icon:te,attributes:{alt:{type:"string"},blockAlignment:{type:"string",default:"wide"},gif:{type:"object"},search:{type:"string"},textAlignment:{type:"string"}},getEditWrapperProps:function(e){var t=e.blockAlignment;if("left"===t||"right"===t||"full"===t)return{"data-align":t}},supports:{html:!1},edit:ee,save:function(e){var t=e.attributes,n=t.alt,i=t.blockAlignment,o=t.gif,a=t.textAlignment;return o&&o.src?Object(r.createElement)("div",{className:"insert-giphy-block-front-end-container align".concat(i),style:{textAlign:a}},Object(r.createElement)("img",{alt:n,src:o.src})):null}})}]);